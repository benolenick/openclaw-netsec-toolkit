# Security Log Analysis Report

**Generated:** [DATE AND TIME]
**Analyst:** OpenClaw Log Analyzer
**System:** [HOSTNAME]
**Log Directory:** [LOG_DIR]
**Time Window:** Last [HOURS] hours (from [CUTOFF_TIME] to [ANALYSIS_TIME])

---

## Executive Summary

[1-3 sentences describing the overall security posture based on log analysis. State the overall threat level and the most significant finding.]

**Overall Threat Level:** [CRITICAL / HIGH / MODERATE / LOW]

---

## Scope

| Parameter | Value |
|---|---|
| Log files analyzed | [LIST OF FILES] |
| Lines processed | [COUNT] |
| Time window | [HOURS] hours |
| Analysis date | [DATE] |

---

## Statistics Overview

| Metric | Count |
|---|---|
| Total failed SSH password attempts | [COUNT] |
| Total invalid user attempts | [COUNT] |
| Accepted authentications | [COUNT] |
| sudo authentication failures | [COUNT] |
| Connection refused/reset events | [COUNT] |
| Unique source IPs (with failures) | [COUNT] |
| fail2ban bans issued | [COUNT] |
| fail2ban unbans issued | [COUNT] |

---

## Findings by Severity

### CRITICAL

[For each CRITICAL finding:]

> **[CATEGORY]** — [DESCRIPTION]
>
> - Source IP: [IP]
> - Failed attempts: [COUNT]
> - Unique usernames targeted: [COUNT]
> - First seen: [TIMESTAMP]
> - Last seen: [TIMESTAMP]
> - fail2ban status: [Banned / Not banned]
> - **Recommended action:** [ACTION]

[If no CRITICAL findings: "No CRITICAL findings in the analyzed time window."]

### HIGH

[For each HIGH finding, same format as CRITICAL]

[If no HIGH findings: "No HIGH findings in the analyzed time window."]

### MEDIUM

[For each MEDIUM finding:]

> **[CATEGORY]** — [DESCRIPTION]
>
> - Details: [BRIEF DETAILS]
> - **Recommended action:** [ACTION]

[If no MEDIUM findings: "No MEDIUM findings in the analyzed time window."]

### LOW

[Summary of LOW findings — do not enumerate each one individually unless there are fewer than 5]

- Total LOW findings: [COUNT]
- Summary: [BRIEF DESCRIPTION OF PATTERNS]

### INFO

[Summary of informational findings]

---

## Top Offending IPs

| Rank | IP Address | Total Failed | Unique Users | Banned | First Seen | Last Seen |
|------|-----------|-------------|-------------|--------|-----------|----------|
| 1 | [IP] | [COUNT] | [COUNT] | [Y/N] | [TIMESTAMP] | [TIMESTAMP] |
| 2 | [IP] | [COUNT] | [COUNT] | [Y/N] | [TIMESTAMP] | [TIMESTAMP] |
| ... | ... | ... | ... | ... | ... | ... |

---

## Successful Logins After Failures

[If any IPs had successful logins after failed attempts, list them here with full context. These are the highest priority items for investigation.]

| IP Address | User (redacted) | Login Time | Prior Failures | Assessment |
|-----------|----------------|-----------|---------------|-----------|
| [IP] | [USER***] | [TIMESTAMP] | [COUNT] | [LIKELY LEGIT / SUSPICIOUS / INVESTIGATE] |

[If none: "No successful logins from IPs with prior failures were detected."]

---

## fail2ban Effectiveness

[If fail2ban data is available:]

| Metric | Value |
|---|---|
| Total bans | [COUNT] |
| Total unbans | [COUNT] |
| Unique IPs banned | [COUNT] |
| Ban effectiveness | [ASSESSMENT] |

[If fail2ban data is not available: "fail2ban log was not found or contained no entries in the analyzed time window."]

---

## Attack Patterns

[Describe any patterns identified across the findings:]

1. **[PATTERN NAME]**: [Description with evidence]
2. **[PATTERN NAME]**: [Description with evidence]

---

## Recommendations

### Immediate Actions (CRITICAL/HIGH findings)

1. [Action item with justification]
2. [Action item with justification]

### Short-term Actions (within 48 hours)

1. [Action item]
2. [Action item]

### Long-term Hardening

1. [Action item]
2. [Action item]
3. [Action item]

---

## Appendix: Files Analyzed

```
[LIST EACH FILE PATH AND LINE COUNT]
```

---

*This report was generated by the OpenClaw Security Log Analyzer skill. All usernames in failed login attempts have been redacted (first 2 characters shown). This analysis is read-only and no blocking or modification actions were taken.*
